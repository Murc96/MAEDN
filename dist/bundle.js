/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";class e{constructor(e,t){this.id=t,this.color=e,this.position=0,this.isOnField=!1,this.isInEndzone=!1}moveOnPlayerBoard(e){this.position+=e}placeOnField(){this.isOnField=!0,this.position=1}removeFromField(){this.isOnField=!1,this.position=0}setIsInEndzone(){this.isInEndzone=!0}getEndzonePosition(){return this.position-41}getIsInEndzone(){return this.isInEndzone}getMaxDistance(e){return e<=44}}class t{constructor(e,t=e){this.color=e,this.name=t,this.myFigures=[],this.createFigures(),this.myPlayerEndzone=[0,0,0,0]}createFigures(){for(let t=1;t<5;t++){let n=new e(this.color,t);this.myFigures.push(n)}}addFigureInEndzone(e){this.myPlayerEndzone[e.getEndzonePosition()]=e}getFiguresOnBank(){let e=[];return this.myFigures.forEach((t=>{t.isOnField||e.push(t.id)})),e}checkAllFiguresInEndzone(){return this.myFigures.every((e=>e.isInEndzone))}checkFiguresOnFieled(){return!!this.myFigures.find((e=>!0===e.isOnField))&&(console.log("hello true on field"),!0)}}class n{constructor(){this.rolledNum=0}rollCube(){this.rolledNum=Math.floor(6*Math.random())+1}getRolledNum(){return this.rolledNum}checkFor6(){return 6===this.rolledNum}}class s{constructor(){this.gameboard=Array(40).fill(0),this.figureStartPoint=0}placeFigure(e,t){const n=t;n?("red"==e.color?this.figureStartPoint=0:"blue"==e.color?this.figureStartPoint=10:"green"==e.color?this.figureStartPoint=20:"yellow"==e.color&&(this.figureStartPoint=30),this.isOccupied(this.figureStartPoint)&&this.resetFigure(this.figureStartPoint),this.gameboard[this.figureStartPoint]=n,n.placeOnField()):console.log("Alle Figuren am Feld")}moveFigure(e,t){let n=this.getIndexOfFigure(e)+t;n>=40&&(n-=40),this.isOccupied(n)&&this.resetFigure(n),this.removeFigureStartPoint(e),e.getIsInEndzone()||(this.gameboard[n]=e)}removeFigureStartPoint(e){const t=this.getIndexOfFigure(e);this.gameboard[t]=0}isOccupied(t){return this.gameboard[t]instanceof e}resetFigure(e){this.gameboard[e].removeFromField()}getIndexOfFigure(e){return this.gameboard.findIndex((t=>t===e))}}class i{constructor(){this.playFieldCoords=[[10,4],[9,4],[8,4],[7,4],[6,4],[6,3],[6,2],[6,1],[6,0],[5,0],[4,0],[4,1],[4,2],[4,3],[4,4],[3,4],[2,4],[1,4],[0,4],[0,5],[0,6],[1,6],[2,6],[3,6],[4,6],[4,7],[4,8],[4,9],[4,10],[5,10],[6,10],[6,9],[6,8],[6,7],[6,6],[7,6],[8,6],[9,6],[10,6],[10,5]]}addId(e,t){const n=this.playFieldCoords.findIndex((e=>e[0]===t[0]&&e[1]===t[1]));-1!==n&&(e.classList.add("playContainer"),e.id=`playfield-${n}`)}}class o{constructor(){this.redEndzone=[[9,5],[8,5],[7,5],[6,5]],this.blueEndzone=[[5,1],[5,2],[5,3],[5,4]],this.greenEndzone=[[1,5],[2,5],[3,5],[4,5]],this.yellowEndzone=[[5,9],[5,8],[5,7],[5,6]],this.redStartPoint=[10,4],this.blueStartPoint=[4,0],this.yellowStartPoint=[6,10],this.greenStartPoint=[0,6],this.redReserve=[[8,1],[8,2],[9,1],[9,2]],this.blueReserve=[[1,1],[1,2],[2,1],[2,2]],this.greenReserve=[[1,8],[1,9],[2,8],[2,9]],this.yellowReserve=[[8,8],[8,9],[9,8],[9,9]]}setEndzone(e,t){const n=this.redEndzone.findIndex((e=>e[0]===t[0]&&e[1]===t[1])),s=this.blueEndzone.findIndex((e=>e[0]===t[0]&&e[1]===t[1])),i=this.yellowEndzone.findIndex((e=>e[0]===t[0]&&e[1]===t[1])),o=this.greenEndzone.findIndex((e=>e[0]===t[0]&&e[1]===t[1]));-1!==n&&(e.classList.add("redZone","endZone"),e.id=`red-${n}`),-1!==s&&(e.classList.add("blueZone","endZone"),e.id=`blue-${s}`),-1!==i&&(e.classList.add("yellowZone","endZone"),e.id=`yellow-${i}`),-1!==o&&(e.classList.add("greenZone","endZone"),e.id=`green-${o}`)}setStartPoints(e,t){this.redStartPoint[0]===t[0]&&this.redStartPoint[1]===t[1]&&e.classList.add("redZone","startPoint"),this.blueStartPoint[0]===t[0]&&this.blueStartPoint[1]===t[1]&&e.classList.add("blueZone","startPoint"),this.yellowStartPoint[0]===t[0]&&this.yellowStartPoint[1]===t[1]&&e.classList.add("yellowZone","startPoint"),this.greenStartPoint[0]===t[0]&&this.greenStartPoint[1]===t[1]&&e.classList.add("greenZone","startPoint")}setReserveBank(e,t){const n=this.redReserve.findIndex((e=>e[0]===t[0]&&e[1]===t[1])),s=this.blueReserve.findIndex((e=>e[0]===t[0]&&e[1]===t[1])),i=this.yellowReserve.findIndex((e=>e[0]===t[0]&&e[1]===t[1])),o=this.greenReserve.findIndex((e=>e[0]===t[0]&&e[1]===t[1]));-1!==n&&(e.classList.add("redBank","playContainer","redZone"),e.id=`redBank-${n+1}`),-1!==s&&(e.classList.add("blueBank","playContainer","blueZone"),e.id=`blueBank-${s+1}`),-1!==i&&(e.classList.add("yellowBank","playContainer","yellowZone"),e.id=`yellowBank-${i+1}`),-1!==o&&(e.classList.add("greenBank","playContainer","greenZone"),e.id=`greenBank-${o+1}`)}}class l{constructor(){this.gameCubeZone=[5,5]}createGamecubeUi(e,t){this.gameCubeZone[0]===t[0]&&this.gameCubeZone[1]===t[1]&&(e.classList.add("gameCube"),e.id="gameCube",e.innerHTML="6")}showGameCubeNum(e){document.getElementById("gameCube").innerHTML=`${e}`}}class r{constructor(){this.playField=new i,this.playerZones=new o,this.gameCubeUi=new l}createGrid(){const e=document.getElementById("playField");for(let t=0;t<11;t++)for(let n=0;n<11;n++){const s=document.createElement("div"),i=[t,n];this.playField.addId(s,i),this.playerZones.setEndzone(s,i),this.playerZones.setStartPoints(s,i),this.playerZones.setReserveBank(s,i),this.gameCubeUi.createGamecubeUi(s,i),e.appendChild(s)}}updateGameBoardUi(e){for(let t=0;t<e.gameboard.length;t++){const n=e.gameboard[t],s=document.getElementById(`playfield-${t}`);s.className="playContainer",0!==e.gameboard[t]&&(s.classList.add(`${n.color}Figure`),s.classList.add("figure"),s.classList.add(`${n.color}Figure${n.id}`)),"playfield-0"===s.id&&s.classList.add("redZone"),"playfield-10"===s.id&&s.classList.add("blueZone"),"playfield-20"===s.id&&s.classList.add("greenZone"),"playfield-30"===s.id&&s.classList.add("yellowZone")}}updateGameboardPlayerBank(e){e.forEach((e=>{let t=e.getFiguresOnBank();if(t)for(let n=1;n<=e.myFigures.length;n++){const s=document.getElementById(`${e.color}Bank-${n}`);t.includes(n)?(s.classList.add(`${e.color}Figure`),s.classList.add("figure"),s.classList.add(`${e.color}Figure${n}`)):(s.classList.remove(`${e.color}Figure`),s.classList.remove("figure"),s.classList.remove(`${e.color}Figure${n}`))}}))}updateGameBoardPlayerEndzone(e){for(let t=0;t<e.myFigures.length;t++){const n=document.getElementById(`${e.color}-${t}`);e.myFigures[t].isInEndzone?n.classList.add(`${e.color}Figure`):n.classList.remove(`${e.color}Figure`)}}highlightFiguresToMove(e){document.querySelectorAll(`.${e.color}Figure`).forEach((e=>{e.classList.add("playerTurn")}))}unlightFiguresToMove(e){document.querySelectorAll(".playContainer").forEach((e=>{e.classList.remove("playerTurn")}))}}class a{constructor(){this.gamePhase=0,this.attempt=0,this.enabledRules=new Set}getGamePhase(){return this.gamePhase}setGamePhaseOne(){this.gamePhase=0}setGamePhaseTwo(){this.gamePhase=1}setEndGame(){this.gamePhase=3}addNoFigureOnFieldAttempts(){this.attempt++}getNoFigureOnFieldAttempts(){return this.attempt}resetNoFigureOnFieldAttempts(){this.attempt=0}handleGameCube6(e){return e.checkFor6()&&this.resetNoFigureOnFieldAttempts(),e.checkFor6()}checkCanMoveOnThrow(e,t){return console.log("num =",e.getRolledNum()),t.checkFiguresOnFieled()?(console.log("hello check on field"),!0):e.checkFor6()?(console.log("hello gamecube check 6"),!0):(console.log("hello checkmove false"),!1)}isRuleEnabled(e){return this.enabledRules.has(e)}enableRule(e){this.enabledRules.add(e)}setRulesFromCheckboxes(e){e.forEach((e=>{this.enableRule(e)}))}}class d{constructor(e){this.gameBoard=new s,this.players=[],this.currentPlayerIndex=0,this.gameCube=new n,this.gameBoardUi=new r,this.createNewGame(),this.gamePhase=0,this.gameRules=new a,this.startScreen=e,this.setGameRulesFromCheckboxes()}createNewGame(){this.gameBoardUi.createGrid()}addPlayer(e){this.players.push(e)}setGameRulesFromCheckboxes(){const e=this.startScreen.getCheckedRules();this.gameRules.setRulesFromCheckboxes(e),console.log("Activated Rules:",e)}ifRuleIsEnabled(e){return this.gameRules.isRuleEnabled(e)}checkForSpecialRules(){this.ifRuleIsEnabled("Philanthrop")&&this.applyPhilanthropRule(),this.ifRuleIsEnabled("LoneFighter")&&this.applyLoneFighterRule(),this.ifRuleIsEnabled("Schlagzwang")&&this.applySchlagzwangRule(),this.ifRuleIsEnabled("SecondRound")&&this.applySecondRoundRule()}applyPhilanthropRule(){console.log("philanthrop rule is active")}applyLoneFighterRule(){console.log("Lone Fighter Rule is active")}applySchlagzwangRule(){console.log("Schlagzwang is active")}applyFriendlyFireRule(e,t){const n=e.myFigures.find((e=>e.position===t));n&&n.position!==t&&(console.log("Friendly Fire rule activated!"),n.removeFromField(),n.placeOnField())}applySecondRoundRule(){console.log("Second Round rule is active")}playGame(){const e=document.getElementById("playField");this.startScreen.changeScreens(),this.gameBoardUi.updateGameboardPlayerBank(this.players),e.addEventListener("click",(e=>{this.checkGamePhase(e.target),this.gameBoardUi.updateGameBoardUi(this.gameBoard)}))}checkGamePhase(e){let t;const n=this.getCurrentPlayer();console.log("player ",n),this.gameBoardUi.updateGameBoardUi(this.gameBoard),0===this.gameRules.getGamePhase()&&"gameCube"===e.id?(this.rollDice(),this.gameRules.checkCanMoveOnThrow(this.gameCube,n)?(this.gameBoardUi.highlightFiguresToMove(n),this.gameRules.setGamePhaseTwo(),this.gameRules.resetNoFigureOnFieldAttempts()):this.gameRules.getNoFigureOnFieldAttempts()<2?this.gameRules.addNoFigureOnFieldAttempts():(this.gameRules.resetNoFigureOnFieldAttempts(),this.nextTurn()),this.checkForSpecialRules()):1===this.gameRules.getGamePhase()&&(t=this.getChosenFigureId(n,e),"number"==typeof t&&(this.moveCurrentPlayerFigure(n.myFigures[t]),this.gameBoardUi.updateGameboardPlayerBank(this.players),this.gameBoardUi.updateGameBoardPlayerEndzone(this.getCurrentPlayer()),this.nextTurn(),this.gameRules.setGamePhaseOne(),this.gameBoardUi.unlightFiguresToMove(n))),n.checkAllFiguresInEndzone()&&(console.log(`Player ${n.color} has won`),this.endGame())}endGame(){this.gameRules.setEndGame()}getChosenFigureId(e,t){return t.classList.contains(`${e.color}Figure1`)?0:t.classList.contains(`${e.color}Figure2`)?1:t.classList.contains(`${e.color}Figure3`)?2:t.classList.contains(`${e.color}Figure4`)?3:null}getCurrentPlayer(){return this.players[this.currentPlayerIndex]}nextTurn(){this.gameRules.handleGameCube6(this.gameCube)||(this.currentPlayerIndex=(this.currentPlayerIndex+1)%this.players.length)}rollDice(){this.gameCube.rollCube(),this.gameBoardUi.gameCubeUi.showGameCubeNum(this.gameCube.rolledNum)}moveCurrentPlayerFigure(e){const t=this.getCurrentPlayer(),n=this.gameCube.getRolledNum(),s=n+e.position;e.isOnField&&s<=40&&e.getMaxDistance(s)?(this.gameBoard.moveFigure(e,n),e.moveOnPlayerBoard(n),this.ifRuleIsEnabled("FriendlyFire")&&this.applyFriendlyFireRule(t,s)):e.isOnField&&s>40&&e.getMaxDistance(s)?(e.moveOnPlayerBoard(n),e.setIsInEndzone(),e.removeFromField(),this.gameBoard.moveFigure(e,n)):e.isOnField?console.log("Fehler moveCurrentPlayerFigure"):(e.placeOnField(),this.gameBoard.placeFigure(t,e))}isGameEnd(e){return e.checkAllFiguresInEndzone()}}const c=new class{constructor(){this.createStartScreen()}createStartScreen(){const e=document.getElementById("start_ui"),t=document.createElement("h1");t.textContent="Mensch Ärgere Dich Nicht",null==e||e.appendChild(t);const n=document.createElement("input");n.setAttribute("type","text"),n.placeholder="Spieler 1",n.id="playerOne",null==e||e.appendChild(n);const s=document.createElement("input");s.setAttribute("type","text"),s.placeholder="Spieler 2",s.id="playerTwo",null==e||e.appendChild(s);const i=document.createElement("input");i.setAttribute("type","text"),i.placeholder="Spieler 3",i.id="playerThree",null==e||e.appendChild(i);const o=document.createElement("input");o.setAttribute("type","text"),o.placeholder="Spieler 4",o.id="playerFour",null==e||e.appendChild(o);const l=document.createElement("div");l.id="specialRulesContainer";const r=document.createElement("input");r.setAttribute("type","checkbox"),r.id="schlagzwangCheckbox";const a=document.createElement("label");a.setAttribute("for","schlagzwangCheckbox"),a.textContent="Schlagzwang";const d=document.createElement("input");d.setAttribute("type","checkbox"),d.id="friendlyFireCheckbox";const c=document.createElement("label");c.setAttribute("for","friendlyFireCheckbox"),c.textContent="Friendly Fire";const h=document.createElement("input");h.setAttribute("type","checkbox"),h.id="philanthropCheckbox";const u=document.createElement("label");u.setAttribute("for","philanthropCheckbox"),u.textContent="Philanthrop";const g=document.createElement("input");g.setAttribute("type","checkbox"),g.id="loneFighterCheckbox";const m=document.createElement("label");m.setAttribute("for","loneFighterCheckbox"),m.textContent="Lone Fighter";const p=document.createElement("input");p.setAttribute("type","checkbox"),p.id="secondRoundCheckbox";const y=document.createElement("label");y.setAttribute("for","secondRoundCheckbox"),y.textContent="Second Round",l.appendChild(r),l.appendChild(a),l.appendChild(document.createElement("br")),l.appendChild(d),l.appendChild(c),l.appendChild(document.createElement("br")),l.appendChild(h),l.appendChild(u),l.appendChild(document.createElement("br")),l.appendChild(g),l.appendChild(m),l.appendChild(document.createElement("br")),l.appendChild(p),l.appendChild(y),null==e||e.appendChild(l);const F=document.createElement("button");F.textContent="Start",F.id="startButton",null==e||e.appendChild(F)}changeScreens(){const e=document.getElementById("start"),t=document.getElementById("content");e.style.display="none",t.style.display="flex"}getCheckedRules(){const e=[];return document.getElementById("schlagzwangCheckbox").checked&&e.push("Schlagzwang"),document.getElementById("friendlyFireCheckbox").checked&&e.push("FriendlyFire"),document.getElementById("philanthropCheckbox").checked&&e.push("Philanthrop"),document.getElementById("loneFighterCheckbox").checked&&e.push("LoneFighter"),document.getElementById("secondRoundCheckbox").checked&&e.push("SecondRound"),e}};document.getElementById("startButton").addEventListener("click",(()=>{console.log("hello start");const e=new d(c),n=new t("red");e.addPlayer(n);const s=new t("blue");e.addPlayer(s);const i=new t("green");e.addPlayer(i);const o=new t("yellow");e.addPlayer(o),e.playGame()}))})();